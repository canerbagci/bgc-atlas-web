extends layout
include components/card

block content
    .container.mt-4
        .row
            .col-12
                +card('Upload GenBank Files')
                    span.info-icon(data-bs-toggle="tooltip" title="The search function accepts antiSMASH compatible GenBank files. Please upload one or more GenBank files to search for similar BGCs in the database.")
                        img(src="/images/info.svg" width="16" height="16" alt="Info", loading = "lazy")
                    form(id='uploadForm' action='/upload' method='post' enctype='multipart/form-data')
                        input(type='hidden' name='_csrf' value=csrfToken)
                        .mb-3
                            input.form-control(type='file' id='formFile' name='file' multiple aria-label='GenBank file upload')
                            button#uploadButton.btn.btn-primary.mt-2(type='submit') Upload
                +card('Selected Files')
                    table.table.table-bordered.mt-3
                        thead
                            tr
                                th Selected Files
                        tbody#fileList
                            tr
                                td.colspan-4.text-center No files selected
                +card()
                    button#submitButton.btn.btn-primary(type='button' aria-describedby='status') Submit
                    p#status(role='status' aria-live='polite') <strong>Status:</strong> Idle

                    .alert.alert-info.mt-3.d-none#jobIdContainer
                        p Your job ID: <strong id="jobIdDisplay"></strong>
                        p Save this ID to check your results later.

                    .alert.alert-info.mt-3.d-none#queueStatusContainer
                        h5 Queue Status
                        p There are currently <strong id="queuedJobsCount">0</strong> jobs in the queue.
                        p Your job will be processed as soon as possible.

                +card('Look Up Previous Results')
                    form#jobLookupForm
                        .input-group
                            input.form-control#jobIdInput(type='text' placeholder='Enter Job ID' aria-label='Job ID')
                            button.btn.btn-outline-secondary(type='submit') Look Up

                +card('Results')
                    table.table.table-bordered.mt-3
                        thead
                            tr
                                th BGC Name
                                th GCF ID
                                th Membership Value
                        tbody#results
                            tr
                                td.colspan-3.text-center No results to display


append head
    link(rel="stylesheet", href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.css")
    script(src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.js")

    link(rel="stylesheet", href="https://cdn.datatables.net/searchbuilder/1.4.2/css/searchBuilder.bootstrap5.min.css")
    link(rel="stylesheet", href="https://cdn.datatables.net/datetime/1.4.1/css/dataTables.dateTime.min.css")
    script(src="https://cdn.datatables.net/datetime/1.4.1/js/dataTables.dateTime.min.js")
    script(src="https://cdn.datatables.net/searchbuilder/1.4.2/js/dataTables.searchBuilder.min.js")
    script(src="https://cdn.datatables.net/searchbuilder/1.4.2/js/searchBuilder.bootstrap5.min.js")
    script(src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js")
    link(rel="stylesheet", href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.dataTables.min.css")
    link(rel="stylesheet", href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css")

    style.
        #upload-status-message {
            font-size: 1em;
            color: #0056b3;
        }

        .putative-bgc {
            background-color: #ffcccb !important;
            color: white !important;
        }

    script(src="/javascripts/search.js")
